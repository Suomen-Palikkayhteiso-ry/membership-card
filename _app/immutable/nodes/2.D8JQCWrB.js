import"../chunks/DsnmJJEf.js";import{o as O,a as it,s as at,e as B}from"../chunks/vsTfc-Pf.js";import{i as W,j as ot,aS as nt,aT as st,aU as rt,p as D,aO as lt,s as S,aP as I,aV as y,g as a,aW as ct,aX as ft,f as C,a as m,b as U,y as X,aY as M,d as _,e as H,r as b,t as Y,D as dt,c as q}from"../chunks/D2jfNRlM.js";import{i as K}from"../chunks/Dt0NqZsh.js";import{l as ut,g as vt,a as pt}from"../chunks/77IAF1aP.js";import{i as G}from"../chunks/CwC1WaIi.js";import{p as P,b as gt,l as Q,s as Z}from"../chunks/DKPhaWNS.js";function ht(s,n,i,o,e){W&&ot();var r=n.$$slots?.[i],d=!1;r===!0&&(r=n.children,d=!0),r===void 0||r(s,d?()=>o:o)}const mt=Symbol("is custom element"),wt=Symbol("is html");function yt(s,n,i,o){var e=_t(s);W&&(e[n]=s.getAttribute(n)),e[n]!==(e[n]=i)&&(i==null?s.removeAttribute(n):typeof i!="string"&&bt(s).includes(n)?s[n]=i:s.setAttribute(n,i))}function _t(s){return s.__attributes??={[mt]:s.nodeName.includes("-"),[wt]:s.namespaceURI===nt}}var J=new Map;function bt(s){var n=s.getAttribute("is")||s.nodeName,i=J.get(n);if(i)return i;J.set(n,i=[]);for(var o,e=s,r=Element.prototype;r!==e;){o=rt(e);for(var d in o)o[d].set&&i.push(d);e=st(e)}return i}var xt=C('<canvas class="border"></canvas>');function $t(s,n){D(n,!1);let i=P(n,"user",8),o=P(n,"tokenDetails",8),e=I(),r,d=I(!1),w=null;async function x(){if(a(d))return;if(w)return w;if(typeof document>"u"||!("fonts"in document)){S(d,!0);return}const t=['700 1rem "Outfit"','400 1rem "Outfit"'];return w=(async()=>{try{const p=t.filter(v=>!document.fonts.check(v));p.length>0&&(await Promise.all(p.map(v=>document.fonts.load(v))),await document.fonts.ready)}catch(p){console.warn("Unable to load fonts for membership card rendering",p)}finally{S(d,!0)}})(),w}function $(t,p){let v;return function(...g){clearTimeout(v),v=setTimeout(()=>t.apply(this,g),p)}}O(async()=>{r=$(h,250),window.addEventListener("resize",r),await lt(),await x(),h()}),it(()=>{r&&window.removeEventListener("resize",r)});let c=I(null),u=I(null);O(()=>{S(c,new window.Image),y(c,a(c).src="figure.png"),y(c,a(c).onload=()=>h()),S(u,new window.Image),y(u,a(u).src="spy.svg"),y(u,a(u).onload=()=>h())});function h(){if(!a(e)||!i()||!o()||!a(d))return;const t=a(e).getContext("2d");if(!t)return;const p=window.devicePixelRatio||1,v=a(e).parentElement.getBoundingClientRect();y(e,a(e).width=v.width*p),y(e,a(e).height=v.width/1.58*p),t.scale(p,p),y(e,a(e).style.width=`${v.width}px`),y(e,a(e).style.height=`${v.width/1.58}px`),t.fillStyle="3887be";const g=20/p,l=v.width,f=v.height;t.beginPath(),t.moveTo(g,0),t.lineTo(l-g,0),t.quadraticCurveTo(l,0,l,g),t.lineTo(l,f-g),t.quadraticCurveTo(l,f,l-g,f),t.lineTo(g,f),t.quadraticCurveTo(0,f,0,f-g),t.lineTo(0,g),t.quadraticCurveTo(0,0,g,0),t.closePath(),t.fillStyle="#52d3d8",t.fill();const R=l*.5,V=l*-.1,j=f*1.37;t.save(),t.beginPath(),t.arc(V,j,R,0,Math.PI*2),t.clip(),t.beginPath(),t.arc(V,j,R,0,Math.PI*2),t.fillStyle="#f2f597",t.fill(),t.restore();const L=l*.7,N=l*1+L*.4,F=f*.8;if(t.save(),t.beginPath(),t.arc(N,F,L,Math.PI*.5,Math.PI*1.5),t.lineTo(l,0),t.lineTo(l,f),t.closePath(),t.clip(),t.beginPath(),t.arc(N,F,L,0,Math.PI*2),t.fillStyle="#3887be",t.fill(),t.restore(),a(u)&&a(u).complete){const T=l*.15,A=l*.03,E=f-T-f*.03;t.drawImage(a(u),A,E,T,T)}if(a(c)&&a(c).complete){const T=l*.5,A=T*(a(c).naturalHeight/a(c).naturalWidth),E=l-T+l*0,et=f*.3;t.drawImage(a(c),E,et,T,A)}const z=l/20;t.font=`700 ${z*1}px 'Outfit', sans-serif`,t.fillStyle="white",t.textAlign="left",t.fillStyle="#f2f597",t.fillText("JÄSENKORTTI",l*.62,f*.15),t.font=`700 ${z*1.2}px 'Outfit', sans-serif`,t.fillStyle="#ffffff",t.fillStyle="white",t.textAlign="left",t.fillText(`${o()?.name?.toUpperCase()}`,l*.05,f*.3),t.font=`700 ${z*.6}px 'Outfit', sans-serif`,t.fillStyle="#000000",t.fillText(`Voimassaolo päättyy: ${o()?.expiration_date||""}`,l*.05,f*.4),t.fillText(`Liittymispäivä: ${o()?.effective_date||""}`,l*.05,f*.475),t.fillText(`Discord: ${o()?.discord||""}`,l*.05,f*.675),t.fillText(`Bricklink: ${o()?.bricklink||""}`,l*.05,f*.6)}ct(()=>(a(e),X(i()),X(o()),a(c),a(u),a(d)),()=>{a(e)&&i()&&o()&&a(c)&&a(u)&&a(d)&&h()}),ft(),G();var k=xt();gt(k,t=>S(e,t),()=>a(e)),m(s,k),U()}var Tt=M("<title> </title>"),St=M('<svg xmlns="http://www.w3.org/2000/svg" class="svelte-1n3xayn"><!><!></svg>');function tt(s,n){let i=P(n,"title",8,null),o=P(n,"viewBox",8);var e=St(),r=_(e);{var d=x=>{var $=Tt(),c=_($,!0);b($),Y(()=>at(c,i())),m(x,$)};K(r,x=>{i()&&x(d)})}var w=H(r);ht(w,n,"default",{}),b(e),Y(()=>yt(e,"viewBox",o())),m(s,e)}var kt=M('<path d="M416 448h-84c-6.6 0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h84c17.7 0 32-14.3 32-32V160c0-17.7-14.3-32-32-32h-84c-6.6 0-12-5.4-12-12V76c0-6.6 5.4-12 12-12h84c53 0 96 43 96 96v192c0 53-43 96-96 96zm-47-201L201 79c-15-15-41-4.5-41 17v96H24c-13.3 0-24 10.7-24 24v96c0 13.3 10.7 24 24 24h136v96c0 21.5 26 32 41 17l168-168c9.3-9.4 9.3-24.6 0-34z"></path>');function Pt(s,n){const i=Q(n,["children","$$slots","$$events","$$legacy"]);tt(s,Z({viewBox:"0 0 512 512"},()=>i,{children:(o,e)=>{var r=kt();m(o,r)},$$slots:{default:!0}}))}var Ct=M('<path d="M497 273L329 441c-15 15-41 4.5-41-17v-96H152c-13.3 0-24-10.7-24-24v-96c0-13.3 10.7-24 24-24h136V88c0-21.4 25.9-32 41-17l168 168c9.3 9.4 9.3 24.6 0 34zM192 436v-40c0-6.6-5.4-12-12-12H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h84c6.6 0 12-5.4 12-12V76c0-6.6-5.4-12-12-12H96c-53 0-96 43-96 96v192c0 53 43 96 96 96h84c6.6 0 12-5.4 12-12z"></path>');function It(s,n){const i=Q(n,["children","$$slots","$$events","$$legacy"]);tt(s,Z({viewBox:"0 0 512 512"},()=>i,{children:(o,e)=>{var r=Ct();m(o,r)},$$slots:{default:!0}}))}var Mt=C('<button type="button" style="position:absolute;top:5vw;left:5vw;width:7.5vw;height:7.5vw;display:flex;align-items:center;justify-content:center;cursor:pointer;z-index:10;background:transparent;border:0;color:white;" aria-label="Logout" class="logout-icon"><!></button>');function Lt(s,n){D(n,!1);let i=P(n,"logout",8);G();var o=Mt(),e=_(o);It(e,{}),b(o),B("click",o,function(...r){i()?.apply(this,r)}),B("keydown",o,r=>{(r.key==="Enter"||r.key===" ")&&i()()}),m(s,o),U()}var zt=C('<div class="space-y-6 text-center"></div> <div class="centered-icon svelte-p3me6"><button class="login-button" type="button" aria-label="Kirjaudu" style="background:none;border:none;padding:0;cursor:pointer;color: #52d3d8;"><!></button></div>',1);function At(s){var n=zt(),i=H(dt(n),2),o=_(i),e=_(o);Pt(e,{size:"10vw"}),b(o),b(i),B("click",o,function(...r){ut?.apply(this,r)}),m(s,n)}var Et=C('<div class="relative space-y-6"><!> <!></div>'),Ot=C('<div class="flex min-h-screen items-center justify-center bg-[#200e3a] p-4 pt-[5vw]"><div class="w-[90vw] max-w-full rounded-xl bg-white shadow-xl"><!></div></div>');function Nt(s,n){D(n,!0);let i=q(null),o=q(null);function e(c){const h=c.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),k=decodeURIComponent(window.atob(h).split("").map(function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(k)}O(async()=>{S(i,await vt(),!0),a(i)&&a(i).id_token&&S(o,e(a(i).id_token),!0)});var r=Ot(),d=_(r),w=_(d);{var x=c=>{var u=Et(),h=_(u);Lt(h,{get logout(){return pt}});var k=H(h,2);$t(k,{get user(){return a(i)},get tokenDetails(){return a(o)}}),b(u),m(c,u)},$=c=>{At(c)};K(w,c=>{a(i)?c(x):c($,!1)})}b(d),b(r),m(s,r),U()}export{Nt as component};
