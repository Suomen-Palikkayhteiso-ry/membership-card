import"../chunks/DsnmJJEf.js";import{o as B,a as it,s as at,e as D}from"../chunks/vsTfc-Pf.js";import{i as K,j as ot,aS as nt,aT as st,aU as rt,p as U,aO as lt,s as S,aP as I,aV as y,g as i,aW as ct,aX as ft,f as C,a as m,b as H,y as Y,aY as M,d as _,e as R,r as b,t as q,D as dt,ah as ut,c as J}from"../chunks/D2jfNRlM.js";import{i as G}from"../chunks/Dt0NqZsh.js";import{l as vt,g as pt,a as ht}from"../chunks/77IAF1aP.js";import{i as Q}from"../chunks/CwC1WaIi.js";import{p as P,b as gt,l as Z,s as tt}from"../chunks/DKPhaWNS.js";function mt(s,n,a,o,e){K&&ot();var r=n.$$slots?.[a],d=!1;r===!0&&(r=n.children,d=!0),r===void 0||r(s,d?()=>o:o)}const wt=Symbol("is custom element"),yt=Symbol("is html");function _t(s,n,a,o){var e=bt(s);K&&(e[n]=s.getAttribute(n)),e[n]!==(e[n]=a)&&(a==null?s.removeAttribute(n):typeof a!="string"&&xt(s).includes(n)?s[n]=a:s.setAttribute(n,a))}function bt(s){return s.__attributes??={[wt]:s.nodeName.includes("-"),[yt]:s.namespaceURI===nt}}var W=new Map;function xt(s){var n=s.getAttribute("is")||s.nodeName,a=W.get(n);if(a)return a;W.set(n,a=[]);for(var o,e=s,r=Element.prototype;r!==e;){o=rt(e);for(var d in o)o[d].set&&a.push(d);e=st(e)}return a}var $t=C('<canvas class="border"></canvas>');function Tt(s,n){U(n,!1);let a=P(n,"user",8),o=P(n,"tokenDetails",8),e=I(),r,d=I(!1),w=null;async function x(){if(i(d))return;if(w)return w;if(typeof document>"u"||!("fonts"in document)){S(d,!0);return}const t=['700 1rem "Outfit"','400 1rem "Outfit"'];return w=(async()=>{try{const p=t.filter(v=>!document.fonts.check(v));p.length>0&&(await Promise.all(p.map(v=>document.fonts.load(v))),await document.fonts.ready)}catch(p){console.warn("Unable to load fonts for membership card rendering",p)}finally{S(d,!0)}})(),w}function $(t,p){let v;return function(...h){clearTimeout(v),v=setTimeout(()=>t.apply(this,h),p)}}B(async()=>{r=$(g,250),window.addEventListener("resize",r),await lt(),await x(),g()}),it(()=>{r&&window.removeEventListener("resize",r)});let c=I(null),u=I(null);B(()=>{S(c,new window.Image),y(c,i(c).src="figure.png"),y(c,i(c).onload=()=>g()),S(u,new window.Image),y(u,i(u).src="spy.svg"),y(u,i(u).onload=()=>g())});function g(){if(!i(e)||!a()||!o()||!i(d))return;const t=i(e).getContext("2d");if(!t)return;const p=window.devicePixelRatio||1,v=i(e).parentElement.getBoundingClientRect();y(e,i(e).width=v.width*p),y(e,i(e).height=v.width/1.58*p),t.scale(p,p),y(e,i(e).style.width=`${v.width}px`),y(e,i(e).style.height=`${v.width/1.58}px`),t.fillStyle="3887be";const h=20/p,l=v.width,f=v.height;t.beginPath(),t.moveTo(h,0),t.lineTo(l-h,0),t.quadraticCurveTo(l,0,l,h),t.lineTo(l,f-h),t.quadraticCurveTo(l,f,l-h,f),t.lineTo(h,f),t.quadraticCurveTo(0,f,0,f-h),t.lineTo(0,h),t.quadraticCurveTo(0,0,h,0),t.closePath(),t.fillStyle="#52d3d8",t.fill();const V=l*.5,j=l*-.1,N=f*1.37;t.save(),t.beginPath(),t.arc(j,N,V,0,Math.PI*2),t.clip(),t.beginPath(),t.arc(j,N,V,0,Math.PI*2),t.fillStyle="#f2f597",t.fill(),t.restore();const L=l*.7,F=l*1+L*.4,X=f*.8;if(t.save(),t.beginPath(),t.arc(F,X,L,Math.PI*.5,Math.PI*1.5),t.lineTo(l,0),t.lineTo(l,f),t.closePath(),t.clip(),t.beginPath(),t.arc(F,X,L,0,Math.PI*2),t.fillStyle="#3887be",t.fill(),t.restore(),i(u)&&i(u).complete){const T=l*.25,A=T/i(u).width,E=l*.025,O=f-T+f*.08;t.drawImage(i(u),E,O,T,i(u).height*A)}if(i(c)&&i(c).complete){const T=l*.5,A=T*(i(c).naturalHeight/i(c).naturalWidth),E=l-T+l*0,O=f*.3;t.drawImage(i(c),E,O,T,A)}const z=l/20;t.font=`700 ${z*1}px 'Outfit', sans-serif`,t.fillStyle="white",t.textAlign="left",t.fillStyle="#f2f597",t.fillText("JÄSENKORTTI",l*.62,f*.15),t.font=`700 ${z*1.2}px 'Outfit', sans-serif`,t.fillStyle="#ffffff",t.fillStyle="white",t.textAlign="left",t.fillText(`${o()?.name?.toUpperCase()}`,l*.04,f*.275),t.font=`700 ${z*.6}px 'Outfit', sans-serif`,t.fillStyle="#000000",t.fillText(`Voimassaolo päättyy: ${o()?.expiration_date||""}`,l*.04,f*.35),t.fillText(`Liittymispäivä: ${o()?.effective_date||""}`,l*.04,f*.425),t.fillText(`Discord: ${o()?.discord||""}`,l*.04,f*.6),t.fillText(`Bricklink: ${o()?.bricklink||""}`,l*.04,f*.525)}ct(()=>(i(e),Y(a()),Y(o()),i(c),i(u),i(d)),()=>{i(e)&&a()&&o()&&i(c)&&i(u)&&i(d)&&g()}),ft(),Q();var k=$t();gt(k,t=>S(e,t),()=>i(e)),m(s,k),H()}var St=M("<title> </title>"),kt=M('<svg xmlns="http://www.w3.org/2000/svg" class="svelte-1n3xayn"><!><!></svg>');function et(s,n){let a=P(n,"title",8,null),o=P(n,"viewBox",8);var e=kt(),r=_(e);{var d=x=>{var $=St(),c=_($,!0);b($),q(()=>at(c,a())),m(x,$)};G(r,x=>{a()&&x(d)})}var w=R(r);mt(w,n,"default",{}),b(e),q(()=>_t(e,"viewBox",o())),m(s,e)}var Pt=M('<path d="M416 448h-84c-6.6 0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h84c17.7 0 32-14.3 32-32V160c0-17.7-14.3-32-32-32h-84c-6.6 0-12-5.4-12-12V76c0-6.6 5.4-12 12-12h84c53 0 96 43 96 96v192c0 53-43 96-96 96zm-47-201L201 79c-15-15-41-4.5-41 17v96H24c-13.3 0-24 10.7-24 24v96c0 13.3 10.7 24 24 24h136v96c0 21.5 26 32 41 17l168-168c9.3-9.4 9.3-24.6 0-34z"></path>');function Ct(s,n){const a=Z(n,["children","$$slots","$$events","$$legacy"]);et(s,tt({viewBox:"0 0 512 512"},()=>a,{children:(o,e)=>{var r=Pt();m(o,r)},$$slots:{default:!0}}))}var It=M('<path d="M497 273L329 441c-15 15-41 4.5-41-17v-96H152c-13.3 0-24-10.7-24-24v-96c0-13.3 10.7-24 24-24h136V88c0-21.4 25.9-32 41-17l168 168c9.3 9.4 9.3 24.6 0 34zM192 436v-40c0-6.6-5.4-12-12-12H96c-17.7 0-32-14.3-32-32V160c0-17.7 14.3-32 32-32h84c6.6 0 12-5.4 12-12V76c0-6.6-5.4-12-12-12H96c-53 0-96 43-96 96v192c0 53 43 96 96 96h84c6.6 0 12-5.4 12-12z"></path>');function Mt(s,n){const a=Z(n,["children","$$slots","$$events","$$legacy"]);et(s,tt({viewBox:"0 0 512 512"},()=>a,{children:(o,e)=>{var r=It();m(o,r)},$$slots:{default:!0}}))}var Lt=C('<button type="button" style="position:absolute;top:5vw;left:5vw;width:7.5vw;height:7.5vw;display:flex;align-items:center;justify-content:center;cursor:pointer;z-index:10;background:transparent;border:0;color:white;" aria-label="Logout" class="logout-icon"><!></button>');function zt(s,n){U(n,!1);let a=P(n,"logout",8);Q();var o=Lt(),e=_(o);Mt(e,{}),b(o),D("click",o,function(...r){a()?.apply(this,r)}),D("keydown",o,r=>{(r.key==="Enter"||r.key===" ")&&a()()}),m(s,o),H()}var At=C('<div class="space-y-6 text-center"></div> <div class="centered-icon svelte-p3me6"><button class="login-button" type="button" aria-label="Kirjaudu" style="background:none;border:none;padding:0;cursor:pointer;color: #52d3d8;"><!> <h1 style="text-transform:uppercase">Avaa tästä</h1></button></div>',1);function Et(s){var n=At(),a=R(dt(n),2),o=_(a),e=_(o);Ct(e,{size:"10vw"}),ut(2),b(o),b(a),D("click",o,function(...r){vt?.apply(this,r)}),m(s,n)}var Ot=C('<div class="relative space-y-6"><!> <!></div>'),Bt=C('<div class="flex min-h-screen items-center justify-center bg-[#200e3a] p-4 pt-[5vw]"><div class="w-[90vw] max-w-full rounded-xl bg-white shadow-xl"><!></div></div>');function Ft(s,n){U(n,!0);let a=J(null),o=J(null);function e(c){const g=c.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),k=decodeURIComponent(window.atob(g).split("").map(function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(k)}B(async()=>{S(a,await pt(),!0),i(a)&&i(a).id_token&&S(o,e(i(a).id_token),!0)});var r=Bt(),d=_(r),w=_(d);{var x=c=>{var u=Ot(),g=_(u);zt(g,{get logout(){return ht}});var k=R(g,2);Tt(k,{get user(){return i(a)},get tokenDetails(){return i(o)}}),b(u),m(c,u)},$=c=>{Et(c)};G(w,c=>{i(a)?c(x):c($,!1)})}b(d),b(r),m(s,r),H()}export{Ft as component};
